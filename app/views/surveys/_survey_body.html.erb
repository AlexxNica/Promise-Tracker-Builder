<div id="survey-body">
  <div data-bind="foreach: inputs" id="input-list">
    <div class="input" data-bind="css: { selected: PT.selectedInput() ? id === PT.selectedInput().id : false }, valueUpdate: 'input'">
      <!-- ko if: inEdit -->
      <table>
        <tr>
          <th class="tall"><%= t(".question_label") %></th>
          <td><input type="text" class="form-control" data-bind="value: label, valueUpdate:'input'" placeholder="<%= t(".question_placeholder") %>" autofocus></td>
        </tr>
        <tr>
          <th><%= t(".answer_type") %></th>
          <td>
            <select class="form-control short inline" data-bind="options: _.values(PT.defaultControls), optionsValue: function(item) {return item.input_type}, optionsText: function(item) {return item.label}, value: input_type"></select>
            <div class="inline margin-left">
              <span data-bind="visible: input_type() == 'binary'">
                <label><%= t(".annotation") %></label><input type="checkbox" data-bind="checked: annotate"></span>
              <span data-bind="visible: input_type() == 'int' || input_type() == 'decimal'">
              <label><%= t(".decimal") %></label><input type="checkbox" data-bind="checked: decimal"></span>
            </div>
          </td>
        </tr>
        <tr>
          <th><%= t(".answer_label") %></th>
          <td>
            <div class="answer">
              <input class="answer-box form-control short" placeholder="<%= t('.their_answer') %>" disabled data-bind="visible: input_type() === 'string' || input_type() === 'decimal' || input_type() === 'int' || input_type() === 'date' || input_type() === 'date'">
              <span class="date-preview glyphicon glyphicon-calendar" data-bind="visible: input_type() === 'date'"></span>
              <div class="android-button" data-bind="visible: input_type() === 'geopoint'"><%= t(".record_location") %></div>

              <div data-bind="visible: input_type() === 'binary'">
                <div class="android-button"><%= t(".take_picture") %></div>
                <div class="android-button"><%= t(".choose_image") %></div>
              </div>

              <div class="options" data-bind="visible: input_type() == 'select' || input_type() == 'select1'">
                <ul class="answer" data-bind="sortable: options, valueUpdate:'input', css: input_type">
                  <li class="option edit">
                    <input data-bind="value: $parent.options()[$index()], valueUpdate:'input'" autofocus>
                    <span class="glyphicon glyphicon-remove-sign delete-option"data-bind="click: $parent.deleteOption, visible: $parent.options().length > 1"></span>
                    </li>
                </ul>
                <div class="phantom-option" data-bind="click: addOption, css: input_type">
                  <li>
                    <span class="dummy-input"><%= t(".add_new_option") %></span>
                  </li>  
                </div>
              </div>
            </div>
          </td>
        </tr>
        <tr>
          <th></th>
          <td>
            <br>
            <label><%= t(".required") %></label><input type="checkbox" data-bind="checked: required">
            <br><br>
            <a href="#" class="btn btn-info" data-bind="click: save"><%= t("defaults.save") %></a>
          </td>
        </tr>
      </table>

      <div class="modify">
        <a href="#" class="btn" data-bind="click: save"><span class="glyphicon glyphicon-floppy-disk"></span> </a>
        <a href="#" class="btn" data-bind="click: $parent.removeInput"><span class="glyphicon glyphicon-trash"></span></a>
      </div>
      <!-- /ko -->

      <!-- ko ifnot: inEdit -->
      <p data-bind="text: $data.label"></p>
      <div class="modify">
        <a href="#" class="btn" data-bind="click: edit"><%= t("surveys.new.edit") %></a>
        <a href="#" class="btn" data-bind="click: $parent.removeInput"><span class="glyphicon glyphicon-trash"></span></a>
      </div>

      <div class="options" data-bind="visible: input_type() === 'select' || input_type() === 'select1'">
        <ul class="answer" data-bind="foreach: options, valueUpdate:'input', css: input_type">
          <li class="option">
            <p class="inline" data-bind="text: $parent.options()[$index()], valueUpdate:'input'"></p>
          </li>
        </ul>
      </div>
      <div class="answer">
        <input class="answer-box form-control short" placeholder="<%= t('.their_answer') %>" disabled data-bind="visible: input_type() === 'string' || input_type() === 'decimal' || input_type() === 'date'">
        <span class="date-preview glyphicon glyphicon-calendar" data-bind="visible: input_type() === 'date'"></span>

        <div class="android-button" data-bind="visible: input_type() === 'geopoint'"><%= t(".record_location") %></div>

        <div data-bind="visible: input_type() === 'binary'">
          <div class="android-button"><%= t(".take_picture") %></div>
          <div class="android-button"><%= t(".choose_image") %></div>
        </div>

      </div>
      <!-- /ko -->
    </div>
  </div>
</div>

<script type="text/javascript">
  PT.getSurvey("<%= survey_path(@survey) %>");
</script>